# Разработка интерфейса для Сервиса межгалактической аналитики

## Инструкция по запуску

1. Запустить бэкенд https://github.com/etozhenerk/shri2025-back
2. Клонировать репозиторий, установить зависимости и запустить фронтенд:

```bash
git clone git@github.com:vovavish/shri-react.git
cd ./shri-react
npm i
npm run dev
```

3. Открыть http://localhost:5173/

## Описание архитектуры

1. UI:
   - 1.1. `components/ui` - переиспользуемые ui компоненты
   - 1.2. `components` - компоненты, собранные из `components/ui`
   - 1.3. `pages` - страницы, собранные из components
2. Бизнес-логика - `services/ReportService`, методы для работы с отчетами
3. Данные - store. Содержит 1 slice для работы с отчетами
4. Работа с бэкендом:
   - 5.1. `api/ReportAPI`, содержит api контроллер бэкенда
   - 5.2. `api/ReportStorageAPI`, содержит api для истории загрузок
5. Типы - `types`, типы для работы с отчетами

## Тестовые сценарии функциональных требований

`Тесты находятся в папке src/tests`

1. Загрузка таблиц с данными и получение аналитики (unit - для функций, связанных с агрегацией, integration - тестирование react компонентов в связке, в зависимости от состояния, e2e - успешные и неуспешные агрегации отчета )
   - Загрузка CSV через форму
     - Пользователь загружает CSV-файл через форму загрузки
     - После загрузки файла он сохранятся в состоянии приложения
     - Кнопка отправки отчета становится активной при загруженном файле
   - При отправки отчета начинается агрегация
   - Drag-and-drop CSV файла
     - Пользователь может загрузить файл через DND
     - Если пользователь загрузил файл невалидного формата, то показывается ошибка
   - Отображение агрегации
     - При успешной агрегации отображаются хайлайты
     - Если пользователь получил ошибку, то отображается заглушка хайлайтов и ошибка
   - Работа после получения аналитики
     - Пользователь очищает форму и она возвращается в изначальное состояние
2. Отображение прогресса обработки (e2e - тестирование с реальным запросом, проверка, что данные накапливаются)
   - После отправки отчета на агрегацию данные накапливаются плавно
3. Генератор тестовых данных для проверки системы (unit - для функций состояния генерации, integration - для тестирования связки react компонентов в зависимости от состояния, e2e - успешные и неупешные генерации тестового файла)
   - При генерации тестовых данных отображается состояние загрузки
   - При ошибке при генерации тестовых данных отображается ошибка
   - После успешной генерации тестовых данных файл сохраняется на устройство пользователя
4. История загрузок, хранимая в localStorage (unit - для функций хранилища историй, integration - для тестирования связки react компонентов, e2e - для взаимодействия с localStorage в реальном браузере)
   - При пустой истории отображается только кнопка сгенерировать больше, перенаправляющая на страницу генерации
   - Если есть история, то отображается сгенерировать больше и очистка
   - Если есть история, то её возможно полностью очистить
   - Если есть история, то можно удалить одну из записей
   - Если есть успешно агрегированные отчеты в истории, то их можно открыть в модалке
   - Если есть невалидные агрегации отчетов в истории, то их нельзя открыть в модалке
5. Навигационное меню для перемещения между разделами (integration)
   - При нажатии на CSV Аналитик открывается домашняя страница
   - При нажатии на CSV Генератор открывается страница генерации
   - При нажатии на История открывается страница истории

## Использованные технологии при тестировании

1. vitest
2. testing-library/react
3. testing-library/user-events
4. testing-library/jest-dom
5. playwright

## Запуск тестов

1. Запуск unit и integration тестов

```bash
npm run test
```

2. Запуск e2e тестов (необходим включенный бэкенд https://github.com/etozhenerk/shri2025-back)

```bash
npm run test:e2e
```

3. Для проверки стабильности тестов была добавлена команда (запускает 3 раза unit и integration тесты)

```bash
npm run test:stable
```
